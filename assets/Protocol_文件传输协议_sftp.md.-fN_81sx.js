import{_ as s,c as a,o as n,a3 as i}from"./chunks/framework.CBHj4tz5.js";const l="/al/assets/image.DnXykx3K.png",p="/al/assets/image-1.i_xSgyqj.png",e="/al/assets/image-2.Bs5b7yDz.png",t="/al/assets/image-5.Ba_WP9K0.png",h="/al/assets/image-9.tjfghoeS.png",k="/al/assets/image-3.B1istZuU.png",r="/al/assets/image-4.BnsmfDMW.png",F="/al/assets/image-6.CA-nbrQf.png",d="/al/assets/image-7.08x3Dp_d.png",c="/al/assets/image-8.bJz_GDzg.png",A=JSON.parse('{"title":"SFTP协议相关","description":"","frontmatter":{},"headers":[],"relativePath":"Protocol/文件传输协议/sftp.md","filePath":"Protocol/文件传输协议/sftp.md","lastUpdated":1732241785000}'),o={name:"Protocol/文件传输协议/sftp.md"},b=i('<h1 id="sftp协议相关" tabindex="-1">SFTP协议相关 <a class="header-anchor" href="#sftp协议相关" aria-label="Permalink to &quot;SFTP协议相关&quot;">​</a></h1><h2 id="linux搭建sftp服务器" tabindex="-1">Linux搭建sftp服务器 <a class="header-anchor" href="#linux搭建sftp服务器" aria-label="Permalink to &quot;Linux搭建sftp服务器&quot;">​</a></h2><ol><li>在Linux上搭建SFTP服务器，可以使用openssh软件包中的sshd守护进程来实现</li><li><code>yum install openssh-server</code> 或者 <code>apt-get install openssh-server</code></li><li>检查sshd服务运行状态 <code>systemctl status sshd</code>, 使其运行<img src="'+l+`" alt="alt text" loading="lazy"></li></ol><h3 id="创建sftp用户" tabindex="-1">创建sftp用户 <a class="header-anchor" href="#创建sftp用户" aria-label="Permalink to &quot;创建sftp用户&quot;">​</a></h3><ol><li>添加用户组sftp</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">groupadd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftp</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行完成后 查看用户组是否创建完成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/group</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>添加用户</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftpuser</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /bin/false 是最严格的禁止login选项，将用户的shell设置为/bin/false，用户会无法登录，并且不会有任何提示。有很多其他选项，具体可以查阅用户shell登录权限</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 执行完成后 查看用户是否创建完成</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/passwd</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="3"><li>修改密码</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftpuser</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="4"><li>创建用户的主目录<br> 上述操作<code>useradd</code> 会默认创建用户的主目录<code>/home/sftpuser</code><br> 根据需要自行调整数据存放目录</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="sshd配置" tabindex="-1">sshd配置 <a class="header-anchor" href="#sshd配置" aria-label="Permalink to &quot;sshd配置&quot;">​</a></h3><h4 id="sshd建议设置参数" tabindex="-1">sshd建议设置参数 <a class="header-anchor" href="#sshd建议设置参数" aria-label="Permalink to &quot;sshd建议设置参数&quot;">​</a></h4><p>Match Group sftp,sftpvisitor ChrootDirectory %h</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Subsystem</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> internal-sftp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  #指定使用sftp服务使用系统自带的internal-sftp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Match</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  sftpuser,sftpuser2,sftpuser3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        #匹配用户，如果要匹配多个组，多个组之间用逗号分割</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ChrootDirectory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  %h</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   #设定属于用户组sftp的用户访问的根文件夹如设置   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">X11Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   #这两行，如果不希望该用户能使用端口转发的话就加上，否则删掉</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowTcpForwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="所有参数解释" tabindex="-1">所有参数解释 <a class="header-anchor" href="#所有参数解释" aria-label="Permalink to &quot;所有参数解释&quot;">​</a></h4><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sshd(8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) 默认从 /etc/ssh/sshd_config 文件(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">或通过</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 命令行选项指定的文件</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)读取配置信息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 配置文件是由</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;指令 值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">对组成的，每行一个。空行和以</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&#39;#&#39;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">开头的行都将被忽略。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 如果值中含有空白符或者其他特殊符号，那么可以通过在两边加上双引号(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;)进行界定。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> [注意]值是大小写敏感的，但指令是大小写无关的。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> 当前所有可以使用的配置指令如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AcceptEnv</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定客户端发送的哪些环境变量将会被传递到会话环境中。[注意]只有SSH-2协议支持环境变量的传递。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         细节可以参考 ssh_config(5) 中的 SendEnv 配置指令。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指令的值是空格分隔的变量名列表(其中可以使用&#39;*&#39;和&#39;?&#39;作为通配符)。也可以使用多个 AcceptEnv 达到同样的目的。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         需要注意的是，有些环境变量可能会被用于绕过禁止用户使用的环境变量。由于这个原因，该指令应当小心使用。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认是不传递任何环境变量。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddressFamily</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 应当使用哪种地址族。取值范围是：&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(默认)、&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inet</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(仅IPv4)、&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inet6</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(仅IPv6)。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AllowGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个指令后面跟着一串用空格分隔的组名列表(其中可以使用&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;通配符)。默认允许所有组登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果使用了这个指令，那么将仅允许这些组中的成员登录，而拒绝其它所有组。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里的&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">组</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;是指&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">主组</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(primary group)，也就是/etc/passwd文件中指定的组。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里只允许使用组的名字而不允许使用GID。相关的 allow/deny 指令按照下列顺序处理：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         DenyUsers, AllowUsers, DenyGroups, AllowGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AllowTcpForwarding</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许TCP转发，默认值为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         禁止TCP转发并不能增强安全性，除非禁止了用户对shell的访问，因为用户可以安装他们自己的转发器。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AllowUsers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个指令后面跟着一串用空格分隔的用户名列表(其中可以使用&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;通配符)。默认允许所有用户登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果使用了这个指令，那么将仅允许这些用户登录，而拒绝其它所有用户。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果指定了 USER@HOST 模式的用户，那么 USER 和 HOST 将同时被检查。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里只允许使用用户的名字而不允许使用UID。相关的 allow/deny 指令按照下列顺序处理：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         DenyUsers, AllowUsers, DenyGroups, AllowGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AuthorizedKeysFile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         存放该用户可以用来登录的 RSA/DSA 公钥。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         该指令中可以使用下列根据连接时的实际情况进行展开的符号：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         %% 表示&#39;%&#39;、%h 表示用户的主目录、%u 表示该用户的用户名。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         经过扩展之后的值必须要么是绝对路径，要么是相对于用户主目录的相对路径。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">.ssh/authorized_keys</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Banner</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         将这个指令指定的文件中的内容在用户进行认证前显示给远程用户。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个特性仅能用于SSH-2，默认什么内容也不显示。&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">none</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示禁用这个特性。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ChallengeResponseAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许质疑-应答(challenge-response)认证。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         所有 login.conf(5) 中允许的认证方式都被支持。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ciphers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定SSH-2允许使用的加密算法。多个算法之间使用逗号分隔。可以使用的算法如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes128-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes192-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes256-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes128-ctr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes192-ctr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aes256-ctr</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3des-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arcfour128</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arcfour256</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arcfour</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">blowfish-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cast128-cbc</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值是可以使用上述所有算法。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ClientAliveCountMax</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         sshd(8) 在未收到任何客户端回应前最多允许发送多少个&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;消息。默认值是 3 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         到达这个上限后，sshd(8) 将强制断开连接、关闭会话。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         需要注意的是，&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;消息与 TCPKeepAlive 有很大差异。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;消息是通过加密连接发送的，因此不会被欺骗；而 TCPKeepAlive 却是可以被欺骗的。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果 ClientAliveInterval 被设为 15 并且将 ClientAliveCountMax 保持为默认值，</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         那么无应答的客户端大约会在45秒后被强制断开。这个指令仅可以用于SSH-2协议。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ClientAliveInterval</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         设置一个以秒记的时长，如果超过这么长时间没有收到客户端的任何数据，</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         sshd(8) 将通过安全通道向客户端发送一个&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;消息，并等候应答。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值 0 表示不发送&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alive</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;消息。这个选项仅对SSH-2有效。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Compression</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否对通信数据进行加密，还是延迟到认证成功之后再对通信数据加密。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         可用值：&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">delayed</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(默认), &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DenyGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个指令后面跟着一串用空格分隔的组名列表(其中可以使用&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;通配符)。默认允许所有组登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果使用了这个指令，那么这些组中的成员将被拒绝登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里的&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">组</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;是指&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">主组</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(primary group)，也就是/etc/passwd文件中指定的组。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里只允许使用组的名字而不允许使用GID。相关的 allow/deny 指令按照下列顺序处理：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         DenyUsers, AllowUsers, DenyGroups, AllowGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DenyUsers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个指令后面跟着一串用空格分隔的用户名列表(其中可以使用&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">?</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;通配符)。默认允许所有用户登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果使用了这个指令，那么这些用户将被拒绝登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果指定了 USER@HOST 模式的用户，那么 USER 和 HOST 将同时被检查。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这里只允许使用用户的名字而不允许使用UID。相关的 allow/deny 指令按照下列顺序处理：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         DenyUsers, AllowUsers, DenyGroups, AllowGroups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ForceCommand</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         强制执行这里指定的命令而忽略客户端提供的任何命令。这个命令将使用用户的登录shell执行(shell -c)。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这可以应用于 shell 、命令、子系统的完成，通常用于 Match 块中。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个命令最初是在客户端通过 SSH_ORIGINAL_COMMAND 环境变量来支持的。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GatewayPorts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许远程主机连接本地的转发端口。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         sshd(8) 默认将远程端口转发绑定到loopback地址。这样将阻止其它远程主机连接到转发端口。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         GatewayPorts 指令可以让 sshd 将远程端口转发绑定到非loopback地址，这样就可以允许远程主机连接了。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示仅允许本地连接，&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示强制将远程端口转发绑定到统配地址(wildcard address)，</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clientspecified</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示允许客户端选择将远程端口转发绑定到哪个地址。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GSSAPIAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许使用基于 GSSAPI 的用户认证。默认值为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。仅用于SSH-2。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GSSAPICleanupCredentials</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否在用户退出登录后自动销毁用户凭证缓存。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。仅用于SSH-2。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HostbasedAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个指令与 RhostsRSAAuthentication 类似，但是仅可以用于SSH-2。推荐使用默认值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         推荐使用默认值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;禁止这种不安全的认证方式。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HostbasedUsesNameFromPacketOnly</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         在开启 HostbasedAuthentication 的情况下，</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定服务器在使用 ~/.shosts ~/.rhosts /etc/hosts.equiv 进行远程主机名匹配时，是否进行反向域名查询。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示 sshd(8) 信任客户端提供的主机名而不进行反向查询。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> HostKey</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         主机私钥文件的位置。如果权限不对，sshd(8) 可能会拒绝启动。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         SSH-1默认是 /etc/ssh/ssh_host_key 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         SSH-2默认是 /etc/ssh/ssh_host_rsa_key 和 /etc/ssh/ssh_host_dsa_key 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         一台主机可以拥有多个不同的私钥。&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsa1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;仅用于SSH-1，&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dsa</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsa</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;仅用于SSH-2。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IgnoreRhosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否在 RhostsRSAAuthentication 或 HostbasedAuthentication 过程中忽略 .rhosts 和 .shosts 文件。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         不过 /etc/hosts.equiv 和 /etc/shosts.equiv 仍将被使用。推荐设为默认值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IgnoreUserKnownHosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否在 RhostsRSAAuthentication 或 HostbasedAuthentication 过程中忽略用户的 ~/.ssh/known_hosts 文件。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。为了提高安全性，可以设为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KerberosAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否要求用户为 PasswordAuthentication 提供的密码必须通过 Kerberos KDC 认证，也就是是否使用Kerberos认证。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         要使用Kerberos认证，服务器需要一个可以校验 KDC identity 的 Kerberos servtab 。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KerberosGetAFSToken</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果使用了 AFS 并且该用户有一个 Kerberos 5 TGT，那么开启该指令后，</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         将会在访问用户的家目录前尝试获取一个 AFS token 。默认为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KerberosOrLocalPasswd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果 Kerberos 密码认证失败，那么该密码还将要通过其它的认证机制(比如 /etc/passwd)。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KerberosTicketCleanup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否在用户退出登录后自动销毁用户的 ticket 。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KeyRegenerationInterval</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         在SSH-1协议下，短命的服务器密钥将以此指令设置的时间为周期(秒)，不断重新生成。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这个机制可以尽量减小密钥丢失或者黑客攻击造成的损失。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         设为 0 表示永不重新生成，默认为 3600(秒)。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ListenAddress</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 监听的网络地址，默认监听所有地址。可以使用下面的格式：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               ListenAddress host|IPv4_addr|IPv6_addr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               ListenAddress host|IPv4_addr:port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               ListenAddress [host|IPv6_addr]:port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果未指定 port ，那么将使用 Port 指令的值。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         可以使用多个 ListenAddress 指令监听多个地址。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LoginGraceTime</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         限制用户必须在指定的时限内认证成功，0 表示无限制。默认值是 120 秒。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LogLevel</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 的日志等级(详细程度)。可用值如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         QUIET, FATAL, ERROR, INFO(默认), VERBOSE, DEBUG, DEBUG1, DEBUG2, DEBUG3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         DEBUG 与 DEBUG1 等价；DEBUG2 和 DEBUG3 则分别指定了更详细、更罗嗦的日志输出。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         比 DEBUG 更详细的日志可能会泄漏用户的敏感信息，因此反对使用。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MACs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定允许在SSH-2中使用哪些消息摘要算法来进行数据校验。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         可以使用逗号分隔的列表来指定允许使用多个算法。默认值(包含所有可以使用的算法)是：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         hmac-md5,hmac-sha1,umac-64@openssh.com,hmac-ripemd160,hmac-sha1-96,hmac-md5-96</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Match</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         引入一个条件块。块的结尾标志是另一个 Match 指令或者文件结尾。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果 Match 行上指定的条件都满足，那么随后的指令将覆盖全局配置中的指令。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         Match 的值是一个或多个&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">条件-模式</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;对。可用的&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">条件</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;是：User, Group, Host, Address 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         只有下列指令可以在 Match 块中使用：AllowTcpForwarding, Banner,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         ForceCommand, GatewayPorts, GSSApiAuthentication,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         KbdInteractiveAuthentication, KerberosAuthentication,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         PasswordAuthentication, PermitOpen, PermitRootLogin,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         RhostsRSAAuthentication, RSAAuthentication, X11DisplayOffset,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         X11Forwarding, X11UseLocalHost</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MaxAuthTries</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定每个连接最大允许的认证次数。默认值是 6 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         如果失败认证的次数超过这个数值的一半，连接将被强制断开，且会生成额外的失败日志消息。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MaxStartups</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         最大允许保持多少个未认证的连接。默认值是 10 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         到达限制后，将不再接受新连接，除非先前的连接认证成功或超出 LoginGraceTime 的限制。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PasswordAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许使用基于密码的认证。默认为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PermitEmptyPasswords</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许密码为空的用户远程登录。默认为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PermitOpen</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定TCP端口转发允许的目的地，可以使用空格分隔多个转发目标。默认允许所有转发请求。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         合法的指令格式如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               PermitOpen host:port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               PermitOpen IPv4_addr:port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">               PermitOpen [IPv6_addr]:port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">any</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;可以用于移除所有限制并允许一切转发请求。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PermitRootLogin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许 root 登录。可用值如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(默认) 表示允许。&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示禁止。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">without-password</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示禁止使用密码认证登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forced-commands-only</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示只有在指定了 command 选项的情况下才允许使用公钥认证登录。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                               同时其它认证方法全部被禁止。这个值常用于做远程备份之类的事情。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PermitTunnel</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许 tun(4) 设备转发。可用值如下：</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;, &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">point-to-point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(layer 3), &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ethernet</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(layer 2), &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;(默认)。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;同时蕴含着&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">point-to-point</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;和&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ethernet</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PermitUserEnvironment</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定是否允许 sshd(8) 处理 ~/.ssh/environment 以及 ~/.ssh/authorized_keys 中的 environment= 选项。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。如果设为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;可能会导致用户有机会使用某些机制(比如 LD_PRELOAD)绕过访问控制，造成安全漏洞。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PidFile</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定在哪个文件中存放SSH守护进程的进程号，默认为 /var/run/sshd.pid 文件。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Port</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 守护进程监听的端口号，默认为 22 。可以使用多条指令监听多个端口。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         默认将在本机的所有网络接口上监听，但是可以通过 ListenAddress 指定只在某个特定的接口上监听。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrintLastLog</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 是否在每一次交互式登录时打印最后一位用户的登录时间。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PrintMotd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 是否在每一次交互式登录时打印 /etc/motd 文件的内容。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Protocol</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定 sshd(8) 支持的SSH协议的版本号。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         &#39;1&#39;和&#39;2&#39;表示仅仅支持SSH-1和SSH-2协议。&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2,1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;表示同时支持SSH-1和SSH-2协议。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PubkeyAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许公钥认证。仅可以用于SSH-2。默认值为&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RhostsRSAAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否使用强可信主机认证(通过检查远程主机名和关联的用户名进行认证)。仅用于SSH-1。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         这是通过在RSA认证成功后再检查 ~/.rhosts 或 /etc/hosts.equiv 进行认证的。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         出于安全考虑，建议使用默认值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">no</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RSAAuthentication</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         是否允许使用纯 RSA 公钥认证。仅用于SSH-1。默认值是&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ServerKeyBits</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定临时服务器密钥的长度。仅用于SSH-1。默认值是 768(位)。最小值是 512 。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> StrictModes</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         指定是否要求 sshd(8) 在接受连接请求前对用户主目录和相关的配置文件进行宿主和权限检查。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         强烈建议使用默认值&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yes</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;来预防可能出现的低级错误。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Subsystem</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         配置一个外部子系统(例如，一个文件传输守护进程)。仅用于SSH-2协议。</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">         值是一个子系统的名字和对应的命令行(含选项和参数)。比如&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/sftp-server&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SyslogFacility</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         指定 sshd(8) 将日志消息通过哪个日志子系统(facility)发送。有效值是：</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         DAEMON, USER, AUTH(默认), LOCAL0, LOCAL1, LOCAL2, LOCAL3, LOCAL4, LOCAL5, LOCAL6, LOCAL7</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TCPKeepAlive</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         指定系统是否向客户端发送 TCP keepalive 消息。默认值是&quot;yes&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         这种消息可以检测到死连接、连接不当关闭、客户端崩溃等异常。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         可以设为&quot;no&quot;关闭这个特性。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UseDNS</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         指定 sshd(8) 是否应该对远程主机名进行反向解析，以检查此主机名是否与其IP地址真实对应。默认值为&quot;yes&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UseLogin</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         是否在交互式会话的登录过程中使用 login(1) 。默认值是&quot;no&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         如果开启此指令，那么 X11Forwarding 将会被禁止，因为 login(1) 不知道如何处理 xauth(1) cookies 。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         需要注意的是，login(1) 是禁止用于远程执行命令的。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         如果指定了 UsePrivilegeSeparation ，那么它将在认证完成后被禁用。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UsePrivilegeSeparation</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         是否让 sshd(8) 通过创建非特权子进程处理接入请求的方法来进行权限分离。默认值是&quot;yes&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         认证成功后，将以该认证用户的身份创建另一个子进程。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         这样做的目的是为了防止通过有缺陷的子进程提升权限，从而使系统更加安全。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> X11DisplayOffset</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         指定 sshd(8) X11 转发的第一个可用的显示区(display)数字。默认值是 10 。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         这个可以用于防止 sshd 占用了真实的 X11 服务器显示区，从而发生混淆。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> X11Forwarding</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         是否允许进行 X11 转发。默认值是&quot;no&quot;，设为&quot;yes&quot;表示允许。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         如果允许X11转发并且sshd(8)代理的显示区被配置为在含有通配符的地址(X11UseLocalhost)上监听。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         那么将可能有额外的信息被泄漏。由于使用X11转发的可能带来的风险，此指令默认值为&quot;no&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         需要注意的是，禁止X11转发并不能禁止用户转发X11通信，因为用户可以安装他们自己的转发器。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         如果启用了 UseLogin ，那么X11转发将被自动禁止。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> X11UseLocalhost</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         sshd(8) 是否应当将X11转发服务器绑定到本地loopback地址。默认值是&quot;yes&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         sshd 默认将转发服务器绑定到本地loopback地址并将 DISPLAY 环境变量的主机名部分设为&quot;localhost&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         这可以防止远程主机连接到 proxy display 。不过某些老旧的X11客户端不能在此配置下正常工作。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         为了兼容这些老旧的X11客户端，你可以设为&quot;no&quot;。</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XAuthLocation</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">         指定 xauth(1) 程序的绝对路径。默认值是 /usr/X11R6/bin/xauth</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br></div></div><h4 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h4><ol><li>如果设置Match user，代表匹配用户，多个用户之间用逗号分割，如果用户没有被Match匹配上，在使用方式上有区别</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Match</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  sftpuser,sftpuser2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ChrootDirectory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  %h</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>⚠假设<code>sftpuser3</code>没有被配置匹配到<br><code>sftpuser2</code>和<code>sftpuser3</code> 的家目录分别为<br><code>/data/sftp/sftpuser2</code><br><code>/data/sftp/sftpuser3</code><br> 通过sftp客户端软件连接显示的根目录不同<br><code>sftpuser2</code>显示： <img src="`+p+'" alt="alt text" loading="lazy"><code>sftpuser3</code>显示： <img src="'+e+'" alt="alt text" loading="lazy"> 由于<code>sftpuser3</code> 没有被匹配到所以它的<code>ChrootDirectory</code>根文件夹被默认为它的家目录<code>/data/sftp/sftpuser3 </code><br> 一般情况下，建议sftp用户只访问自己的根目录</p><hr><ol start="2"><li>对于没被匹配到的用户，例如<code>sftpuser3</code>, 如果给予其家目录<code>/data/sftp/sftpuser3</code>权限（所有者和群组），该用户是可以在<code>/data/sftp/sftpuser3</code>下创建目录和操作文件的</li></ol><hr><ol start="3"><li>对于匹配到的用户，例如<code>sftpuser2</code>, 用户的家目录<code>/data/sftp/sftpuser2</code>所有者和群组必须是root,且权限最高755,新建目录默认就是这个权限，该用户无法在<code>/data/sftp/sftpuser2</code>下创建目录和操作文件，只能通过<code>root</code>用户手动创建子目录并把所有者和群组转交给该用户，该用户才可正常使用sftp进行文件的操作</li></ol><h2 id="windows搭建sftp服务器" tabindex="-1">Windows搭建sftp服务器 <a class="header-anchor" href="#windows搭建sftp服务器" aria-label="Permalink to &quot;Windows搭建sftp服务器&quot;">​</a></h2><h3 id="基于freesshd-存在中文乱码问题" tabindex="-1">基于freesshd(存在中文乱码问题) <a class="header-anchor" href="#基于freesshd-存在中文乱码问题" aria-label="Permalink to &quot;基于freesshd(存在中文乱码问题)&quot;">​</a></h3><p>参考：<a href="https://www.jb51.net/softjc/912161.html" target="_blank" rel="noreferrer">https://www.jb51.net/softjc/912161.html</a></p><h3 id="基于openssh搭建sftp服务器" tabindex="-1">基于OpenSSH搭建SFTP服务器 <a class="header-anchor" href="#基于openssh搭建sftp服务器" aria-label="Permalink to &quot;基于OpenSSH搭建SFTP服务器&quot;">​</a></h3><ol><li>下载OpenSSH<br><a href="https://github.com/PowerShell/Win32-OpenSSH/releases" target="_blank" rel="noreferrer">Github下载地址</a></li><li>安装OpenSSH<br> 直接下载msi版本，点击安装即可</li><li>配置和启动服务 <ul><li><code>Win+R</code>键打开运行命令窗口，输入<code>Services.msc</code><br><img src="'+t+'" alt="alt text" loading="lazy"></li><li>将图中的服务启动并修改启动类型为自动 <img src="'+h+'" alt="alt text" loading="lazy"></li></ul></li><li>配置防火墙策略 <ul><li>打开控制面板-控制面板\\系统和安全\\Windows Defender 防火墙，点击高级设置，右键新建入站规则，选择端口，下一页<br><img src="'+k+'" alt="alt text" loading="lazy"></li><li>选择特定端口，输入22，下一页<br><img src="'+r+'" alt="alt text" loading="lazy"></li><li>选择允许连接，下一页<br><img src="'+F+'" alt="alt text" loading="lazy"></li><li>根据需求选取配置文件，下一页<br><img src="'+d+'" alt="alt text" loading="lazy"></li><li>输入名称，完成即可<br><img src="'+c+`" alt="alt text" loading="lazy"></li></ul></li><li>修改sshd配置<br> 默认位置：<code>C:\\ProgramData\\ssh\\sshd_config</code></li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 最后一行后面加入</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ForceCommand</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> internal-sftp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置用户登录后默认目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Match</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> User</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sftpuser</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ChrootDirectory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">FTP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Disable tunneling, authentication agent, TCP and X11 forwarding.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PermitTunnel</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowAgentForwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AllowTcpForwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">X11Forwarding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PermitTTY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div>`,32),u=[b];function g(y,C,B,m,q,S){return n(),a("div",null,u)}const E=s(o,[["render",g]]);export{A as __pageData,E as default};
