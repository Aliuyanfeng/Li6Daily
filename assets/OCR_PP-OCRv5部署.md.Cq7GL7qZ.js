import{_ as a,c as i,o as n,aN as l}from"./chunks/framework.DXgs1r1w.js";const p="/Li6Daily/assets/image.CmnbQuYd.png",g=JSON.parse('{"title":"PP-OCRv5部署","description":"","frontmatter":{"date":"2025-11-24T15:52:17.000Z","title":"PP-OCRv5部署","permalink":"/pages/b63a9d","top":true,"categories":["OCR"]},"headers":[],"relativePath":"OCR/PP-OCRv5部署.md","filePath":"OCR/PP-OCRv5部署.md","lastUpdated":1765964436000}'),e={name:"OCR/PP-OCRv5部署.md"};function t(h,s,k,r,d,c){return n(),i("div",null,[...s[0]||(s[0]=[l(`<h1 id="aarch64架构-pp-ocrv5离线部署" tabindex="-1">aarch64架构 PP-OCRv5离线部署 <a class="header-anchor" href="#aarch64架构-pp-ocrv5离线部署" aria-label="Permalink to &quot;aarch64架构 PP-OCRv5离线部署&quot;">​</a></h1><h2 id="pp-ocrv5部署" tabindex="-1">PP-OCRv5部署 <a class="header-anchor" href="#pp-ocrv5部署" aria-label="Permalink to &quot;PP-OCRv5部署&quot;">​</a></h2><h3 id="服务化部署" tabindex="-1">服务化部署 <a class="header-anchor" href="#服务化部署" aria-label="Permalink to &quot;服务化部署&quot;">​</a></h3><p>通过将推理功能封装为服务，客户端可以通过网络请求来访问这些服务，以获取推理结果。<br> 制作镜像，容器服务化运行,参照本地python运行方式，将离线python依赖打入镜像，采用离线模型，离线字体运行，额外需要OpenCV依赖，因为PaddleOCR涉及到图像的处理，</p><div class="language-dockerfile vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">dockerfile</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> docker.1ms.run/library/python:3.11.14-bookworm</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置时区为上海</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TZ=Asia/Shanghai</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置工作目录</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WORKDIR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /home/antiy/paddlex</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> requirements.txt .</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制离线包</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> aarch64_offline_pkgs ./aarch64_offline_pkgs</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制OCR.yaml配置文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> OCR.yaml .</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制模型文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PPModel ./PPModel</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 复制字体文件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COPY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fonts ./fonts</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 sed 命令替换默认的软件源为阿里云镜像源</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sed -i </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s@deb.debian.org@mirrors.aliyun.com@g&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /etc/apt/sources.list.d/debian.sources </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 sed 命令注释掉 docker-clean 配置文件中的 APT 和 DPkg 清理命令</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sed -i -e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s/^APT/# APT/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -e </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;s/^DPkg/# DPkg/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /etc/apt/apt.conf.d/docker-clean</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装libgl1  OpenCV 运行依赖</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apt-get update &amp;&amp; apt-get install -y --no-install-recommends libgl1 libglib2.0-0 &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置环境变量，关闭pip缓存</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PIP_NO_CACHE_DIR=off</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 下载依赖包到离线目录（仅在需要更新离线包时使用）</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RUN pip download --retries=5 --timeout=120 -r requirements.txt -d /aarch64_offline_pkgs -i https://pypi.tuna.tsinghua.edu.cn/simple --progress-bar off</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 采用离线包安装依赖</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">RUN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pip3.11 install --no-index --find-links=./aarch64_offline_pkgs -r requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置字体环境变量</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PADDLE_PDX_LOCAL_FONT_FILE_PATH=/home/antiy/paddlex/fonts/simfang.ttf</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置缓存目录</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ENV</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PADDLE_PDX_CACHE_HOME=/home/antiy/paddlex</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 暴露端口并运行PaddleX服务</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">EXPOSE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 9997</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CMD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;paddlex&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--serve&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--pipeline&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./OCR.yaml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--host&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--port&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;9997&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>制作完成后可以按需到其他机器运行，命令参考：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -itd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --privileged=true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --restart=always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> paddlex</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --shm-size=8g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --network=host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> paddlex:3.3.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> paddlex</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --serve</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --pipeline</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./OCR.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9997</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="端侧部署" tabindex="-1">端侧部署 <a class="header-anchor" href="#端侧部署" aria-label="Permalink to &quot;端侧部署&quot;">​</a></h3><p>主要是Android端部署</p><h3 id="高性能推理" tabindex="-1">高性能推理 <a class="header-anchor" href="#高性能推理" aria-label="Permalink to &quot;高性能推理&quot;">​</a></h3><p>PaddleX 通过高性能推理插件在生产环境中提升模型推理速度。插件支持多后端并能自动配置，让使用者无需处理复杂底层细节即可获得更快的响应性能。它不仅能加速完整产线，也可用于独立模块的推理加速。</p><p><img src="`+p+'" alt="alt text" loading="lazy"></p>',12)])])}const o=a(e,[["render",t]]);export{g as __pageData,o as default};
