import{_ as a,c as s,o as t,aN as e}from"./chunks/framework.DXgs1r1w.js";const c=JSON.parse('{"title":"Git撤回Commit","description":"","frontmatter":{"date":"2026-01-15T14:45:12.000Z","title":"Git撤回Commit","permalink":"/pages/3de2af","categories":["Other","Git相关"]},"headers":[],"relativePath":"Other/01.Git相关/Git撤回Commit.md","filePath":"Other/01.Git相关/Git撤回Commit.md","lastUpdated":1768471229000}'),l={name:"Other/01.Git相关/Git撤回Commit.md"};function n(h,i,r,p,d,o){return t(),s("div",null,[...i[0]||(i[0]=[e(`<h1 id="git-commit-撤回指南" tabindex="-1">Git Commit 撤回指南 <a class="header-anchor" href="#git-commit-撤回指南" aria-label="Permalink to &quot;Git Commit 撤回指南&quot;">​</a></h1><p>Git 中撤回 commit 的本质是回退 HEAD 指针或生成反向提交。 第一判断条件：是否已经 push 到远端。</p><h2 id="一、未-push-的-commit-本地提交" tabindex="-1">一、未 push 的 commit（本地提交） <a class="header-anchor" href="#一、未-push-的-commit-本地提交" aria-label="Permalink to &quot;一、未 push 的 commit（本地提交）&quot;">​</a></h2><h3 id="_1-撤回-commit-保留代码" tabindex="-1">1. 撤回 commit，保留代码 <a class="header-anchor" href="#_1-撤回-commit-保留代码" aria-label="Permalink to &quot;1. 撤回 commit，保留代码&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --soft</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEAD~1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>说明：</p><ul><li>最近一次 commit 被撤回</li><li>修改内容仍保留</li><li>可重新提交</li></ul><h3 id="_2-撤回-commit-并丢弃代码-高风险" tabindex="-1">2. 撤回 commit，并丢弃代码（高风险） <a class="header-anchor" href="#_2-撤回-commit-并丢弃代码-高风险" aria-label="Permalink to &quot;2. 撤回 commit，并丢弃代码（高风险）&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEAD~1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>说明：</p><ul><li>commit 与代码同时删除</li><li>不可恢复（除非使用 reflog）</li></ul><h3 id="_3-修改最近一次-commit" tabindex="-1">3. 修改最近一次 commit <a class="header-anchor" href="#_3-修改最近一次-commit" aria-label="Permalink to &quot;3. 修改最近一次 commit&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commit</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --amend</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>适用场景：</p><ul><li>修改 commit message</li><li>补充遗漏文件</li></ul><p>注意：</p><ul><li>仅适用于未 push 的提交</li></ul><h2 id="二、已-push-的-commit-远端存在" tabindex="-1">二、已 push 的 commit（远端存在） <a class="header-anchor" href="#二、已-push-的-commit-远端存在" aria-label="Permalink to &quot;二、已 push 的 commit（远端存在）&quot;">​</a></h2><h3 id="_1-使用-revert-推荐" tabindex="-1">1. 使用 revert（推荐） <a class="header-anchor" href="#_1-使用-revert-推荐" aria-label="Permalink to &quot;1. 使用 revert（推荐）&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> revert</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">commit-i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>特点：</p><ul><li>生成新的 commit</li><li>用于撤销指定提交</li><li>不破坏历史</li><li>不影响他人协作</li></ul><p>适用分支：</p><ul><li>main</li><li>develop</li></ul><h3 id="_2-强制回退历史-慎用" tabindex="-1">2. 强制回退历史（慎用） <a class="header-anchor" href="#_2-强制回退历史-慎用" aria-label="Permalink to &quot;2. 强制回退历史（慎用）&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> reset</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --hard</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> HEAD~1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>或：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --force-with-lease</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>风险说明：</p><ul><li>重写远端历史</li><li>可能导致他人分支异常</li><li>仅限个人分支</li></ul><h2 id="三、常见场景速查" tabindex="-1">三、常见场景速查 <a class="header-anchor" href="#三、常见场景速查" aria-label="Permalink to &quot;三、常见场景速查&quot;">​</a></h2><table tabindex="0"><thead><tr><th>场景</th><th>推荐命令</th></tr></thead><tbody><tr><td>未 push，想修改提交</td><td>git commit --amend</td></tr><tr><td>未 push，想撤回提交</td><td>git reset --soft</td></tr><tr><td>已 push，公共分支</td><td>git revert</td></tr><tr><td>已 push，私人分支</td><td>reset + force</td></tr></tbody></table><h2 id="四、使用原则" tabindex="-1">四、使用原则 <a class="header-anchor" href="#四、使用原则" aria-label="Permalink to &quot;四、使用原则&quot;">​</a></h2><ul><li>能 revert 就不要 force</li><li>公共分支优先保证历史稳定</li><li>是否影响他人是第一判断条件</li></ul>`,34)])])}const k=a(l,[["render",n]]);export{c as __pageData,k as default};
